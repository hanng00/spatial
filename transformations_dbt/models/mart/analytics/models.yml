version: 2

models:
  - name: mart_politician360
    description: "Complete Politician360 view with all touchpoints, metrics, and analytics"
    columns:
      - name: intressent_id
        description: "Primary key - unique politician identifier (VARCHAR, from int_politicians)"
        tests:
          - unique
          - not_null
      - name: display_name
        description: "Politician's display name (VARCHAR, standardized from personlista)"
      - name: full_name
        description: "Politician's full name (VARCHAR, constructed from first + last name)"
      - name: party
        description: "Politician's party (VARCHAR, cleaned and standardized)"
      - name: electoral_district
        description: "Electoral district (VARCHAR, valkrets from personlista)"
      - name: birth_year
        description: "Year of birth (VARCHAR, format: YYYY)"
      - name: gender
        description: "Gender (VARCHAR, values: 'man', 'kvinna')"
      - name: member_status
        description: "Current membership status (VARCHAR, indicates if currently active)"
      - name: total_touchpoints
        description: "Total number of touchpoints (INTEGER, sum of votes + speeches + documents)"
      - name: total_votes
        description: "Total number of votes (INTEGER, count of voting touchpoints)"
      - name: total_speeches
        description: "Total number of speeches (INTEGER, count of speech touchpoints)"
      - name: total_documents
        description: "Total number of documents authored (INTEGER, count of document touchpoints)"
      - name: first_touchpoint_date
        description: "Date of first touchpoint (VARCHAR, earliest touchpoint_date)"
      - name: last_touchpoint_date
        description: "Date of most recent touchpoint (VARCHAR, latest touchpoint_date)"
      - name: active_days
        description: "Number of days with activity (INTEGER, count of distinct touchpoint dates)"
      - name: parliamentary_sessions_active
        description: "Number of parliamentary sessions active (INTEGER, count of distinct rm values)"
      - name: yes_votes
        description: "Number of yes votes (INTEGER, count where vote_choice = 'Ja')"
      - name: no_votes
        description: "Number of no votes (INTEGER, count where vote_choice = 'Nej')"
      - name: abstained_votes
        description: "Number of abstained votes (INTEGER, count where vote_choice = 'Avst√•r')"
      - name: yes_vote_percentage
        description: "Percentage of yes votes (DECIMAL, yes_votes/total_votes * 100)"
      - name: avg_touchpoints_per_day
        description: "Average touchpoints per active day (DECIMAL, total_touchpoints/active_days)"
      - name: current_age
        description: "Current age (INTEGER, calculated from birth_year and current date)"
      - name: activity_status
        description: "Activity status (VARCHAR, values: 'Very Active' if last touchpoint < 30 days, 'Active' < 90 days, 'Less Active' < 365 days, 'Inactive' otherwise)"
      - name: recent_touchpoints
        description: "Summary of recent touchpoints (VARCHAR, concatenated string of last 5 touchpoints)"
      - name: created_at
        description: "Timestamp when record was created (TIMESTAMP, current_timestamp)"

  - name: mart_document_geography
    description: "Document geography aggregation - aggregates documents by electoral district and time for map visualization"
    columns:
      - name: electoral_district
        description: "Electoral district (VARCHAR, valkrets)"
        tests:
          - not_null
      - name: document_year
        description: "Year of documents (INTEGER)"
      - name: document_month
        description: "Month of documents (INTEGER, 1-12)"
      - name: document_count
        description: "Total number of documents (INTEGER)"
      - name: politician_count
        description: "Number of distinct politicians involved (INTEGER)"
      - name: party_count
        description: "Number of distinct parties involved (INTEGER)"
      - name: question_count
        description: "Number of questions (fr) (INTEGER)"
      - name: proposition_count
        description: "Number of propositions (prop) (INTEGER)"
      - name: report_count
        description: "Number of reports (bet) (INTEGER)"
      - name: motion_count
        description: "Number of motions (INTEGER)"
      - name: committee_count
        description: "Number of distinct committees (INTEGER)"
      - name: geography_time_key
        description: "Composite key for time-series analysis (VARCHAR, format: electoral_district_YYYY_MM)"
